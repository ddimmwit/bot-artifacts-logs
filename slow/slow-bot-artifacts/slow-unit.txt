# /etc/systemd/system/telegram-bot.service
[Unit]
Description=Telegram bot (aiogram) long polling
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User=root
WorkingDirectory=/root/bot/botg
Environment=DATABASE_URL=postgresql+asyncpg://botuser:Hryehrpg43h3@localhost:5432/botdb
Environment=PYTHONUNBUFFERED=1
Environment=PYTHONOPTIMIZE=2
Environment=PYTHONDONTWRITEBYTECODE=1
Environment=PYTHONFAULTHANDLER=0
Environment=MALLOC_ARENA_MAX=2
Environment=PYTHONMALLOC=malloc
Environment=TZ=Europe/Moscow

# üîß –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –ª–∏–º–∏—Ç—ã
LimitNOFILE=65536
LimitNPROC=4096

# ‚ö†Ô∏è –£–±—Ä–∞–ª–∏ –æ–ø–∞—Å–Ω—ã–π —Ä–µ–∞–ª—Ç–∞–π–º (–º–æ–∂–µ—Ç —É–±–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–∞ 4 —è–¥—Ä–∞—Ö)
Nice=-5
OOMScoreAdjust=-500
IOWeight=800

# ‚úÖ –†–∞–∑—Ä–µ—à–∞–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ 3.5 —è–¥–µ—Ä –∏–∑ 4
CPUQuota=350%

ExecStart=/root/bot/.venv/bin/python /root/bot/botg/bot.py
Restart=always
RestartSec=3

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ journal (—É–¥–æ–±–Ω–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)
StandardOutput=journal
StandardError=journal
SyslogIdentifier=telegram-bot

[Install]
WantedBy=multi-user.target
